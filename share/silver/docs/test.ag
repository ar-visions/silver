import <stdio.h>

class something
    i32  mem = 4
    u64  outside [ i32 an_arg2 ]
    none action  [ i32 an_arg, i64 another, string mem ]
        puts[ 'something is equal to {mem}' ]

class aclass of main
    f32 member = 9.2
    f64 aconst = 1.4

	none init []
        something s[mem: 8]
        s.action[1, 2]
        puts[ 'i can verify its value is {s.mem}' ]
    
    i32[ string ] key-values
        'key':      2
        'another':  44

    construct [ f64 m ]
        aconst = 2.0 * m

    cast f32[ ]
        return f32[ 1.1 ]

##

#import chatgpt
#    model:'gpt-5'

# arrays have an optional comma, but required comma when defining an array shape (last-dim-stride)
i = array <i32, 3x2> [ 1 2, 3 4, 2 2 ]
m : array <path>     [ 'car1.spec' 'car2.spec' 'car3.spec' ]

# return types must be type-expr based, 
# we cannot take in a 'something' for example, 
# because it may be the first operation in a none returning fn
func string-together [ something:string ] string
    return '{something} and {something} else'

main aclass
    member : f32 [ 1.2 ] # public is default in silver ([-] verify)

	func init [ ]
        str: string-together["an input string"]

        i:i32 [ 2 ]
        switch [ i ]
            case 0: printf['case is 0']
            case 1: printf['case is 1']
            case 2: printf['case is 2']
            case 3: printf['case is 3']
            case 4: printf['case is 4']
            default: printf['case is something else']
        
        # str += "... append this"
        # printf [ "actual string: %s with our member %.2f", str, member ]
# ----------------------------------------------


# here we are demonstrating a design mode in silver, using available module data
const for i in m export images/{i} using chatgpt
    [['with these cars, we generate picturesque scenes of good shots of our car designs on Europa, 
they ride atop magnetic-plasma confinement on a waht is a track of fields with gaps allowing one to
see through to the surface in caves on on surface of planet.']],
     [ $ path images/car1.png, $ path images/car1.png ],
     'do something great with this one, given inspiration from car1 and car2, {secret}'

import <stdio.h, ctype.h>

# 
# 
import KhronosGroup:Vulkan-Headers/main
    <vulkan/vulkan.h>

ifdef mac
    import KhronosGroup:MoltenVK/main
        > ./fetchDependencies --macos
        -DANOTHER=2
        -DTHIS_IS_HOW_PEOPLE_NORMALLY_SEE_IT=1

import KhronosGroup:Vulkan-Loader
    -DSOMETHING=1

import KhronosGroup:Vulkan-Tools
    -DBUILD_CUBE=ON

struct a-struct2
    #array-of-data : array <i8, 32x1>
    str2 : string

something : string[ 'a string of sort..' ]

func construct-something [ silly:string ] int using chatgpt
    'construct the silliest string you can come up with given the context'
    done

aa : 2 # i64
bb : i32[ 2 ]
cc : i32[ 3 ]
ff : string[ string-together['hi'] ]

func a-function [ e:string ] none
    puts[ 'something {e}' ]

class engine
    m1      : string
    m2      : string
    state   : i32
    aa      : a-struct2 [str2:'lol']

    fn returns2 [ i:int, b:string ]    'not guarded.. can certainly proceed without my own instance check.. {m1}'
    fn returns  [ i:int, b:string ] -> 'this is a string and our state is {m1}'

class engine2
    m2 : string

engine vk
	intern instance : VkInstance
    public version  : float [ 1.3 ]

    cast   i32 -> i32 [ 4 ]
    
    fn init[] -> none # none is an alias for void
        puts 'vulkan {version} is loading...\n'
        vkCreateInstance
            [ # temps are handled for you, and automatically referenced or given as literal depending on the type
                sType:      VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO
                pNext:      null
                flags:      0
                pApplicationInfo: [
                    sType:              VK_STRUCTURE_TYPE_APPLICATION_INFO # C definitions from macros available
                    pNext:              null
                    pApplicationName:   'vk-app'
                    applicationVersion: VK_MAKE_VERSION(1, 0, 0) # notice: macros use parenthesis
                    pEngineName:        'trinity'
                    engineVersion:      VK_MAKE_VERSION(1, 0, 0)
                    apiVersion:         (version == 1.3f) ? VK_API_VERSION_1_3 : VK_API_VERSION_1_2
                ]
            ], null, ref instance # when giving a member variable, we must specify ref if it that type is required
        
        return # optional for void fn

another : string[ 'hi' ]
alt: 'hello'

# this is how we subclass in silver; base-type first, then our new type
# in this case, main is an abstract class to indicate we are an app, and not a library
main test_vulkan
    public  member              : fp16 [ 1.2 ] # fp16 type
    public  variable-name       : 2.1 # these are not arrays, they are singular values; we use [ ] instead of ( ) for object construction
	public  queue_family_index  : i32 [ 2 ] # local members in functions cannot specify public or intern

    intern  vk                  : vulkan

    public our_array_repeats    : array <i64, 32>     [ 1 2 3 4 ]
    public our_array_truncates  : array <i64, 32>     [ 9 9 9 ]
    public our_array_repeats2   : array <i64, 4x4>    [ 9 9 9 9, 4 4 4 4 ]
    public array_empty          : array <i64>         []
    public map_empty            : map   <string, i64> []
    public map_default_null     : map   <string, i64>

    fn test_llm [] -> i32 using chatgpt
        ['simply return 2 + 2, but before you return print a funny joke', file[ 'docs/image-test.png' ]]
        ['now multiply the return value by 2']

	fn init [ ] # default is none for return
		queue_family_index : 4
        i : 0

        vk : vulkan [ ]

        array_empty.push[ 1, 2, 3, 4, 5, 6, 7, 8, 9 ]

        for i : 0, i < 8, i += 1
            print[ 'i is {i} and could-be {i + 1} next' ]

        # define multiple 
        for [ i : 0, ii : 2 ], i < 88, i += ii
            ii += ii

        our_blank.concat[ our_blank ]

        run_cast = cast i32 [ vk ]

        variables = 2
        printf [ "this is constant, and cannot receive {variables}, but we may still use with printf: %s", string[ i ] ]

        while [ i < 2 ]
            i += 1

        result: float [ member * variable-name ]
##