import chatgpt
    model:'gpt-5'

#import <test.cc>

# we separate headers by comma if we want to include multiple in one line
import <stdio.h, ctype.h>

import KhronosGroup:Vulkan-Headers/main
    <vulkan/vulkan.h>

# import can ONLY be defined at the module level, never inside fn or classes
# here after its checked out, we run an > arb-command
ifdef mac
    import KhronosGroup:MoltenVK/main
        > ./fetchDependencies --macos
        -DANOTHER=2
        -DTHIS_IS_HOW_PEOPLE_NORMALLY_SEE_IT=1

import KhronosGroup:Vulkan-Loader
    -DSOMETHING=1

import KhronosGroup:Vulkan-Tools
    -DBUILD_CUBE=ON

struct a-struct2
    #array-of-data : array <i8, 32x1>
    str2 : string

fn construct-something [ silly:string ]
    int [ silly.len ]

fn a-function [ stupid:string ] none
    printf[ 'something' ]

class engine
    m1      : string
    m2      : string
    state   : i32
    aa      : a-struct2 [str2:'lol']

    fn returns2 [ i:int, b:string ]    'not guarded.. can certainly proceed without my own instance check.. {m1}'
    fn returns  [ i:int, b:string ] -> 'this is a string and our state is {m1}'

class engine2
    m2 : string

engine vk
	intern instance : VkInstance
    public version  : float [ 1.3 ]

    cast   i32 -> i32 [ 4 ]
    
    fn init[] -> none # none is an alias for void
        puts 'vulkan {version} is loading...\n'
        vkCreateInstance
            [ # temps are handled for you, and automatically referenced or given as literal depending on the type
                sType:      VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO
                pNext:      null
                flags:      0
                pApplicationInfo: [
                    sType:              VK_STRUCTURE_TYPE_APPLICATION_INFO # C definitions from macros available
                    pNext:              null
                    pApplicationName:   'vk-app'
                    applicationVersion: VK_MAKE_VERSION(1, 0, 0) # notice: macros use parenthesis
                    pEngineName:        'trinity'
                    engineVersion:      VK_MAKE_VERSION(1, 0, 0)
                    apiVersion:         (version == 1.3f) ? VK_API_VERSION_1_3 : VK_API_VERSION_1_2
                ]
            ], null, ref instance # when giving a member variable, we must specify ref if it that type is required
        
        return # optional for void fn

# we may need to support instances in meta via syntax config
# not remotely sure how to do this in c though

# we know this value, and can also set it with an import config
# our import may facilitate api initialization at top where applicable
# import our-module
#       another: 'hi2'

another : string[ 'hi' ]
alt: 'hello'

# this is how we subclass in silver; base-type first, then our new type
# in this case, main is an abstract class to indicate we are an app, and not a library
main test_vulkan
    public  member              : fp16 [ 1.2 ] # fp16 type
    public  variable-name       : 2.1 # these are not arrays, they are singular values; we use [ ] instead of ( ) for object construction
	public  queue_family_index  : i32 [ 2 ] # local members in functions cannot specify public or intern

    intern  vk                  : vulkan

    public our_array_repeats    : array <i64, 32>     [ 1 2 3 4 ]
    public our_array_truncates  : array <i64, 32>     [ 9 9 9 ]
    public our_array_repeats2   : array <i64, 4x4>    [ 9 9 9 9, 4 4 4 4 ]
    public array_empty          : array <i64>         []
    public map_empty            : map   <string, i64> []
    public map_default_null     : map   <string, i64>

    fn test_llm [] -> i32 using chatgpt
        ['simply return 2 + 2, but before you return print a funny joke', file[ 'docs/image-test.png' ]]
        ['now multiply the return value by 2']

	fn init [ ] # default is none for return
		queue_family_index : 4
        i : 0

        vk : vulkan [ ]

        array_empty.push[ 1, 2, 3, 4, 5, 6, 7, 8, 9 ]

        for i : 0, i < 8, i += 1
            print[ 'i is {i} and could-be {i + 1} next' ]

        # define multiple 
        for [ i : 0, ii : 2 ], i < 88, i += ii
            ii += ii

        our_blank.concat[ our_blank ]

        run_cast = cast i32 [ vk ]

        printf [ "this is constant, and cannot receive {variables}, but we may still use with printf: %s", cstr[string[ i ]] ]

        while [ i < 2 ]
            i += 1

        result: float [ member * variable-name ]
    